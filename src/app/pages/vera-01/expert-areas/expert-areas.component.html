<section id="faq" class="py-20">
	<div class="relative max-w-7xl mx-auto px-6">
		<header class="mb-12">
			<h2 class="mt-3 text-3xl md:text-5xl font-semibold leading-tight mb-20">
				Välj Bland Många
				<span
					class="font-semibold text-transparent bg-clip-text bg-gradient-to-r from-veraGold to-veraBronze"
					>Expertområden.</span
				>
			</h2>
		</header>

		<div class="mx-auto max-w-7xl grid grid-cols-1 lg:grid-cols-12 gap-20">
			<div class="lg:col-span-12">
				<div class="relative">
					<div
						class="rounded-2xl bg-white/5 p-4 sm:p-6"
						style="
							background-image: linear-gradient(
									rgba(0, 0, 0, 0.9),
									rgba(0, 0, 0, 0.9)
								),
								url(https://www.ksdlaw.se/wp-content/uploads/2021/02/tingey-injury-law-firm-L4YGuSg0fxs-unsplash-scaled-e1613720877952.jpg);
							background-repeat: no-repeat;
							background-size: cover;
							background-position: center;
						"
					>
						<!-- Presets + Sök + Kategorier -->

						<!-- <div class="relative">
						<svg
							class="pointer-events-none absolute left-3 top-2.5 h-5 w-5 text-zinc-500"
							viewBox="0 0 20 20"
							fill="currentColor"
						>
							<path
								fill-rule="evenodd"
								d="M12.9 14.32a8 8 0 111.414-1.414l3.39 3.39a1 1 0 01-1.415 1.415l-3.39-3.39zM14 8a6 6 0 11-12 0 6 6 0 0112 0z"
								clip-rule="evenodd"
							/>
						</svg>
						<input
							type="text"
							[value]="query()"
							(input)="query.set(($any($event.target).value || '').toString())"
							placeholder="Sök t.ex. bevis, förhandling, GDPR..."
							class="w-full rounded-xl bg-zinc-900 pl-10 pr-3 py-2.5 text-sm text-white placeholder:text-zinc-500 ring-1 ring-inset ring-white/10 focus:outline-none focus:ring-2 focus:ring-veraGold"
						/>
					</div> -->

						<div
							class="mt-8 grid gap-3 sm:grid-cols-[1fr_auto] sm:items-center"
						>
							<div class="flex flex-wrap justify-end gap-2">
								@for (p of presets; track p.id) {
								<button
									type="button"
									(click)="selectPreset(p.id)"
									class="rounded-full px-3 py-1.5 text-xs font-medium transition"
									[class.bg-veraBronze]="isPresetActive(p)"
									[class.text-white]="isPresetActive(p)"
									[class.ring-1]="!isPresetActive(p) && p.id !== 'tom'"
									[class.bg-transparent]="!isPresetActive(p)"
									[class.border]="p.id === 'tom' && !isPresetActive(p)"
									[class.border-veraBronze]="
										p.id === 'tom' && !isPresetActive(p)
									"
									[attr.aria-pressed]="isPresetActive(p)"
									[attr.aria-label]="p.name"
								>
									{{ p.name }}
								</button>
								}
							</div>
						</div>

						<!-- Lista (kompakt) -->
						<div
							class="mt-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"
						>
							@for (exp of visibleList(); track exp.key) {
							<button
								type="button"
								(click)="toggle(exp.key)"
								class="group relative rounded-2xl bg-white/5 p-5 text-left ring-1 ring-white/10 transition hover:ring-white/20"
							>
								<div
									class="absolute right-4 top-4 flex h-6 w-6 items-center justify-center rounded-full border-2"
									[class.bg-veraGold]="selected().has(exp.key)"
									[class.border-veraGold]="selected().has(exp.key)"
									[class.border-zinc-500]="!selected().has(exp.key)"
								>
									@if (selected().has(exp.key)) {
									<svg
										class="h-4 w-4 text-black"
										viewBox="0 0 20 20"
										fill="currentColor"
									>
										<path
											fill-rule="evenodd"
											d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
											clip-rule="evenodd"
										/>
									</svg>
									}
								</div>

								<h3 class="text-base font-semibold text-white">
									{{ exp.title }}
								</h3>
								<p class="mt-1.5 line-clamp-2 text-sm text-zinc-400">
									{{ exp.short }}
								</p>
							</button>
							}
						</div>

						@if (!showAll() && filteredCount() > MAX_VISIBLE) {
						<div class="mt-5 text-center">
							<button
								type="button"
								(click)="showAll.set(true)"
								class="rounded-md border border-white/15 bg-white/5 px-4 py-2 text-sm text-white hover:bg-white/10"
							>
								Visa fler ({{ filteredCount() - MAX_VISIBLE }})
							</button>
						</div>
						} @if (filteredCount() === 0) {
						<div
							class="mt-8 rounded-xl border border-white/10 p-8 text-center text-zinc-400"
						>
							Inga träffar. Prova en annan sökning.
						</div>
						}
					</div>
					<br />
					<br />

					<!-- Sticky bottombar (visas när något är valt) -->
					<div>
						<div
							class="mx-auto flex max-w-6xl items-center justify-between gap-3 px-4 py-3"
						>
							<div class="flex items-center gap-3">
								<span
									class="inline-flex h-6 min-w-6 items-center justify-center rounded-full bg-veraGold px-2 text-xs font-semibold text-black"
									>{{ selectedCount() }}</span
								>
								<p class="text-sm text-zinc-300">valda expertområden</p>
							</div>
							<button
								[disabled]="selectedCount() == 0"
								type="button"
								(click)="openForm()"
								class="rounded-md bg-veraGold px-5 py-2 text-sm font-semibold text-black shadow-sm hover:opacity-90"
							>
								Begär demo
							</button>
						</div>
					</div>

					<p class="sr-only">Frågor och svar om VERA-01</p>
					<div
						class="absolute inset-x-0 -bottom-6 h-px bg-gradient-to-r from-veraGold via-white/1"
					></div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- Modal -->
@if (showForm()) {
<div class="fixed inset-0 z-50 flex items-end justify-center sm:items-center">
	<div class="absolute inset-0 bg-black/60" (click)="closeForm()"></div>
	<div
		class="relative z-10 w-full max-w-lg rounded-2xl border border-white/10 bg-zinc-950 p-6 shadow-xl"
	>
		<div class="flex items-start justify-between gap-4">
			<div>
				<h3 class="text-xl font-semibold text-white">Begär demo</h3>
				<p class="mt-1 text-sm text-zinc-400">
					Vi återkommer snabbt via e‑post.
				</p>
			</div>
			<button
				type="button"
				(click)="closeForm()"
				class="rounded-full bg-white/5 p-2 text-zinc-400 hover:text-white"
				aria-label="Stäng"
			>
				<svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
					<path
						fill-rule="evenodd"
						d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
						clip-rule="evenodd"
					/>
				</svg>
			</button>
		</div>

		<form class="mt-5 grid gap-3" (ngSubmit)="onSubmit()">
			<input
				type="text"
				name="name"
				autocomplete="name"
				placeholder="Ditt namn"
				[(ngModel)]="contact.name"
				required
				class="rounded-md bg-white/5 px-3.5 py-2 text-sm text-white placeholder:text-zinc-500 ring-1 ring-inset ring-white/10 focus:outline-none focus:ring-2 focus:ring-veraGold"
			/>
			<input
				type="email"
				name="email"
				autocomplete="email"
				placeholder="E‑post"
				[(ngModel)]="contact.email"
				required
				class="rounded-md bg-white/5 px-3.5 py-2 text-sm text-white placeholder:text-zinc-500 ring-1 ring-inset ring-white/10 focus:outline-none focus:ring-2 focus:ring-veraGold"
			/>
			<input
				type="text"
				name="org"
				autocomplete="organization"
				placeholder="Organisation (valfritt)"
				[(ngModel)]="contact.org"
				class="rounded-md bg-white/5 px-3.5 py-2 text-sm text-white placeholder:text-zinc-500 ring-1 ring-inset ring-white/10 focus:outline-none focus:ring-2 focus:ring-veraGold"
			/>
			<button
				type="submit"
				[disabled]="selectedCount() === 0"
				class="mt-1 rounded-md bg-veraGold px-6 py-2.5 text-sm font-semibold text-black shadow-sm hover:opacity-90 disabled:bg-zinc-700 disabled:text-zinc-300"
			>
				Skicka ({{ selectedCount() }})
			</button>
		</form>
	</div>
</div>
}
